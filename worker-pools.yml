---
# This file contains definitions for the worker pools related to Firefox CI.
#
# Each worker pool is named by its <provisionerId>/<workerType> pair, each with
# the following structure (matching that for taskcluster-worker-manager):
#
# - `description` -- description of this workerType
# - `owner` -- owner of this workerType
# - `email_on_error` -- if true, email the owner on provisioning errors
# - `provider_id` -- the worker-manager provider for this worker pool
# - `config` -- the configuration for this worker pool, specific to the provider type
#
# A top-level `image` property in the config will be interpreted by ci-configuration and
# translated into a region[..].launchSpec.ImageId value based on worker-pools.yml.
worker-defaults:
  lifecycle:
    queueInactivityTimeout: 7200
    registrationTimeout: 1800
    reregistrationTimeout: 345600
  worker-config:
    by-implementation:
      docker-worker:
        shutdown:
          enabled: true
          afterIdleSeconds: 900
        deviceManagement:
          hostSharedMemory: {enabled: false}
          kvm: {enabled: false}
        artifacts:
          # FIXME: remove after workers are updated to >= 45.0.1
          skipCompressionExtensions:
            - .7z
            - .bz2
            - .deb
            - .dmg
            - .flv
            - .gif
            - .gz
            - .jpeg
            - .jpg
            - .png
            - .swf
            - .tbz
            - .tgz
            - .webp
            - .whl
            - .woff
            - .woff2
            - .xz
            - .zip
            - .zst
            - lz4
      generic-worker/windows:
        genericWorker:
          config:
            idleTimeoutSecs: 90
            cachesDir: Z:\caches
            cleanUpTaskDirs: true
            deploymentId: f37dd7ee1cae
            disableReboots: false
            downloadsDir: Z:\downloads
            ed25519SigningKeyLocation: C:\generic-worker\ed25519-private.key
            livelogExecutable: C:\generic-worker\livelog.exe
            livelogPUTPort: 60022
            numberOfTasksToRun: 0
            runAfterUserCreation: C:\generic-worker\task-user-init.cmd
            runTasksAsCurrentUser: false
            sentryProject: generic-worker
            shutdownMachineOnIdle: true
            shutdownMachineOnInternalError: true
            taskclusterProxyExecutable: C:\generic-worker\taskcluster-proxy.exe
            taskclusterProxyPort: 80
            tasksDir: Z:\
            wstAudience: firefoxcitc
      generic-worker/worker-runner-windows:
        genericWorker:
          config:
            cachesDir: Z:\caches
            cleanUpTaskDirs: true
            disableReboots: false
            downloadsDir: Z:\downloads
            livelogExecutable: C:\generic-worker\livelog.exe
            ed25519SigningKeyLocation: C:\generic-worker\ed25519-private.key
            idleTimeoutSecs: 600
            numberOfTasksToRun: 0
            runAfterUserCreation: C:\generic-worker\task-user-init.cmd
            runTasksAsCurrentUser: false
            sentryProject: generic-worker
            shutdownMachineOnIdle: true
            shutdownMachineOnInternalError: true
            taskclusterProxyExecutable: C:\generic-worker\taskcluster-proxy.exe
            taskclusterProxyPort: 80
            tasksDir: Z:\
            wstAudience: firefoxcitc
      generic-worker/worker-runner-linux:
        genericWorker:
          config:
            cachesDir: /home/ubuntu/caches
            cleanUpTaskDirs: true
            disableReboots: false
            downloadsDir: /home/ubuntu/downloads
            livelogExecutable: /home/ubuntu/generic_worker/livelog
            ed25519SigningKeyLocation: /home/ubuntu/generic_worker/ed25519-private.key
            # This timeout is set very low to avoid burning money on the GPU instances
            # that use this configuration. If other pools need a different idle timeout
            # we should probably split this at some point.
            idleTimeoutSecs: 300  # 5 minutes
            numberOfTasksToRun: 0
            sentryProject: generic-worker
            shutdownMachineOnIdle: true
            shutdownMachineOnInternalError: true
            taskclusterProxyExecutable: /home/ubuntu/generic_worker/taskcluster-proxy
            taskclusterProxyPort: 80
            tasksDir: /home/ubuntu/tasks
            wstAudience: firefoxcitc

pools:
  - pool_id: infra/build-decision
    description: Worker for firefox-ci automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    provider_id: fxci-level1-gcp
    config:
      minCapacity: 1
      maxCapacity: 4
      regions: [us-central1, us-west1]
      image: monopacker-docker-worker-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - &persistent-disk-75
              autoDelete: true
              boot: true
              initializeParams:
                diskSizeGb: 75
                sourceImage: <image>
              type: PERSISTENT
            - &scratch-disk
              autoDelete: true
              initializeParams:
                diskType: diskTypes/local-ssd
              type: SCRATCH
              interface: NVME
          machine_type: n2-standard-2
          capacityPerInstance: 8
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/b-linux-gcp'
    description: Worker for Firefox automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: gecko-1
      - pool-group: gecko-2
      - pool-group: gecko-3
        chain-of-trust: trusted
      - pool-group: comm-1
      - pool-group: comm-2
      - pool-group: comm-3
        chain-of-trust: trusted
      - pool-group: app-services-1
      - pool-group: app-services-3
        chain-of-trust: trusted
      - pool-group: mozillaonline-1
      - pool-group: mozillaonline-3
        chain-of-trust: trusted
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity:
        by-pool-group:
          gecko-.*: 1000
          comm-.*: 300
          app-services-1: 50
          app-services-3: 100
          mozillaonline-.*: 10
          default: 100
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - &persistent-disk-20
              autoDelete: true
              boot: true
              initializeParams:
                diskSizeGb: 20
                sourceImage: <image>
              type: PERSISTENT
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
          machine_type: c2-standard-16
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: 'gecko-1/b-linux-gcp-relops757-test'
    description: Worker for Firefox automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    provider_id: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity: 10
      regions: [us-central1, us-west1]
      image: monopacker-docker-worker-relops757
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-20
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
          machine_type: c2-standard-16
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/b-linux-gcp-bug1797804-n2'
    description: Worker for Firefox automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: gecko-1
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity: 50
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      instance_types:
        - disks:
            - *persistent-disk-20
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
          machine_type: n2-custom-16-73728
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/b-linux-gcp'
    description: Worker for Firefox automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: glean-1
      - pool-group: glean-3
        chain-of-trust: trusted
      - pool-group: mobile-1
      - pool-group: mobile-3
        chain-of-trust: trusted
      - pool-group: mozilla-1
      - pool-group: mozillavpn-1
      - pool-group: mozillavpn-3
        chain-of-trust: trusted
      - pool-group: adhoc-1
      - pool-group: adhoc-3
        chain-of-trust: trusted
      - pool-group: scriptworker-1
      - pool-group: scriptworker-3
        chain-of-trust: trusted
      - pool-group: xpi-1
      - pool-group: xpi-3
        chain-of-trust: trusted
      - pool-group: releng-1
      - pool-group: releng-3
        chain-of-trust: trusted
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      minCapacity:
        by-pool-group:
          glean-.*: 2
          default: 0
      maxCapacity:
        by-pool-group:
          mobile-.*: 50
          mozilla-.*: 10
          mozillavpn-.*: 10
          default: 100
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-20
            - *scratch-disk
          machine_type: n2-standard-4
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/b-linux-large-gcp'
    description: Worker for Firefox automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: gecko-1
      - pool-group: gecko-2
      - pool-group: gecko-3
        chain-of-trust: trusted
      - pool-group: comm-1
      - pool-group: comm-2
      - pool-group: comm-3
        chain-of-trust: trusted
      - pool-group: mozillavpn-1
      - pool-group: mozillavpn-3
        chain-of-trust: trusted
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity:
        by-pool-group:
          gecko-.*: 1000
          comm-.*: 20
          default: 10
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-20
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
          machine_type: n2-custom-32-73728
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/b-linux-large-gcp'
    description: Worker for Firefox Translations automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: translations-1
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      worker-config:
        genericWorker:
          config:
            # 2592000s is 30 days.
            maxTaskRunTime: 2592000
            enableInteractive: true
      minCapacity: 0
      maxCapacity: 50
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-20
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
          machine_type: n2-custom-32-262144
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/b-linux-large-gcp-300gb'
    description: Big workers with big disks - intended for Firefox Translations only
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: translations-1
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      worker-config:
        genericWorker:
          config:
            # 2592000s is 30 days.
            maxTaskRunTime: 2592000
            enableInteractive: true
      minCapacity: 0
      maxCapacity: 50
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - &persistent-disk-300
              autoDelete: true
              boot: true
              initializeParams:
                diskSizeGb: 300
                sourceImage: <image>
              type: PERSISTENT
          machine_type: n2-custom-32-262144
          scheduling: spot
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/b-linux-large-gcp'
    description: Worker for Firefox automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: mobile-1
      - pool-group: mobile-3
        chain-of-trust: trusted
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity:
        by-pool-group:
          mobile-1: 200
          mobile-3: 100
          default: 10
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-20
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
          machine_type: n2-standard-8
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/b-linux-xlarge-gcp'
    description: Worker for Firefox automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: gecko-1
      - pool-group: gecko-2
      - pool-group: gecko-3
        chain-of-trust: trusted
      - pool-group: comm-1
      - pool-group: comm-2
      - pool-group: comm-3
        chain-of-trust: trusted
      - pool-group: mobile-1
      - pool-group: mobile-3
        chain-of-trust: trusted
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity:
        by-pool-group:
          gecko-.*: 1000
          comm-.*: 20
          mobile-.*: 100
          default: 10
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-20
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
          machine_type: n2-custom-64-131072
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/b-linux-xlarge-gcp-bug1797804-c2'
    description: Worker for Firefox automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: gecko-1
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity: 10
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      instance_types:
        - disks:
            - *persistent-disk-20
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
            - *scratch-disk
          machine_type: c2-standard-60
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/decision-gcp'
    description: Worker for Firefox automation
    owner: release+tc-workers@mozilla.com
    email_on_error: false
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    variants:
      - pool-group: gecko-1
      - pool-group: gecko-2
      - pool-group: gecko-3
        chain-of-trust: trusted
      - pool-group: comm-1
      - pool-group: comm-2
      - pool-group: comm-3
        chain-of-trust: trusted
    config:
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      security:
        by-chain-of-trust:
          trusted: trusted
          default:
      minCapacity:
        by-pool-group:
          gecko-[13]: 5
          default: 0
      maxCapacity:
        by-pool-group:
          gecko-1: 40
          gecko-3: 20
          default: 4
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-75
            - *scratch-disk
          machine_type: n2-standard-4
          capacityPerInstance: 2
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/decision-gcp'
    description: Worker for Firefox automation
    owner: release+tc-workers@mozilla.com
    email_on_error: false
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    variants:
      - pool-group: adhoc-1
      - pool-group: adhoc-3
        chain-of-trust: trusted
      - pool-group: app-services-1
      - pool-group: app-services-3
        chain-of-trust: trusted
      - pool-group: glean-1
      - pool-group: glean-3
        chain-of-trust: trusted
      - pool-group: mozillavpn-1
      - pool-group: mozillavpn-3
        chain-of-trust: trusted
      - pool-group: scriptworker-1
      - pool-group: scriptworker-3
        chain-of-trust: trusted
      - pool-group: xpi-1
      - pool-group: xpi-3
        chain-of-trust: trusted
      - pool-group: ci-1
      - pool-group: ci-3
        chain-of-trust: trusted
      - pool-group: relops-3
        chain-of-trust: trusted
      - pool-group: taskgraph-1
      - pool-group: taskgraph-3
        chain-of-trust: trusted
      - pool-group: releng-1
      - pool-group: releng-3
        chain-of-trust: trusted
      - pool-group: mobile-1
      - pool-group: mobile-3
        chain-of-trust: trusted
      - pool-group: mozilla-1
      - pool-group: translations-1
      - pool-group: nss-1
    config:
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      security:
        by-chain-of-trust:
          trusted: trusted
          default:
      minCapacity:
        by-pool-group:
          '(app-services|glean|mozillavpn|mobile|mozilla)-1': 1
          default: 0
      maxCapacity: 10
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-75
            - *scratch-disk
          machine_type: n2-standard-2
          capacityPerInstance: 2
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/images-gcp'
    description: 'Builds docker images; NOTE: capacity set to 1 instead of 3
      to try to avoid [issues with dind](https://bugzilla.mozilla.org/show_bug.cgi?id=1427096)'
    owner: release+tc-workers@mozilla.com
    email_on_error: false
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    variants:
      - pool-group: gecko-1
      - pool-group: gecko-2
      - pool-group: gecko-3
        chain-of-trust: trusted
      - pool-group: comm-1
      - pool-group: comm-2
      - pool-group: comm-3
        chain-of-trust: trusted
      - pool-group: adhoc-1
      - pool-group: adhoc-3
        chain-of-trust: trusted
      - pool-group: app-services-1
      - pool-group: app-services-3
        chain-of-trust: trusted
      - pool-group: mozilla-1
      - pool-group: mozillavpn-1
      - pool-group: mozillavpn-3
        chain-of-trust: trusted
      - pool-group: mobile-1
      - pool-group: mobile-3
        chain-of-trust: trusted
      - pool-group: glean-1
      - pool-group: glean-3
        chain-of-trust: trusted
      - pool-group: xpi-1
      - pool-group: xpi-3
        chain-of-trust: trusted
      - pool-group: taskgraph-1
      - pool-group: taskgraph-3
        chain-of-trust: trusted
      - pool-group: ci-1
      - pool-group: ci-3
        chain-of-trust: trusted
      - pool-group: scriptworker-1
      - pool-group: scriptworker-3
        chain-of-trust: trusted
      - pool-group: translations-1
    config:
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      security:
        by-chain-of-trust:
          trusted: trusted
          default:
      minCapacity: 0
      maxCapacity:
        by-pool-group:
          (comm|gecko)-.*: 30
          default: 10
      worker-config: {dindImage: taskcluster/dind-service:v4.1}
      regions: [us-central1, us-west1]
      instance_types:
        by-pool-group:
          mobile-.*:
            - minCpuPlatform: Intel Cascadelake
              disks:
                - *persistent-disk-75
                - *scratch-disk
                - *scratch-disk
                - *scratch-disk
                - *scratch-disk
              machine_type: n2-standard-32
              capacityPerInstance: 1
              networkInterfaces:
                - accessConfigs:
                    - type: ONE_TO_ONE_NAT
          (taskgraph|ci)-.*:
            - minCpuPlatform: Intel Cascadelake
              disks:
                - *persistent-disk-75
                - *scratch-disk
              machine_type: n2-standard-2
              capacityPerInstance: 1
              networkInterfaces:
                - accessConfigs:
                    - type: ONE_TO_ONE_NAT
          default:
            - minCpuPlatform: Intel Cascadelake
              disks:
                - *persistent-disk-75
                - *scratch-disk
              machine_type: n2-standard-4
              capacityPerInstance: 1
              networkInterfaces:
                - accessConfigs:
                    - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/t-linux-xlarge{suffix}-gcp'
    description: Worker for gecko-based automation.
    owner: release+tc-workers@mozilla.com
    variants:
      - pool-group: gecko-t
        suffix: ''
      - pool-group: gecko-3
        suffix: ''
        chain-of-trust: trusted
      - pool-group: comm-t
        suffix: ''
      - pool-group: gecko-t
        suffix: -source
      - pool-group: comm-t
        suffix: -source
      - pool-group: nss-t
        suffix: ''
    email_on_error: true
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity:
        by-pool-group:
          gecko-.*:
            by-suffix:
              '': 2500
              -source: 200
          nss-t: 100
          comm-t: 10
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-gcp-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-75
            - *scratch-disk
          machine_type: n2-standard-4
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: 'gecko-t/t-linux-kvm-gcp'
    description: Worker for gecko-based automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    provider_id: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity: 400
      regions: [us-central1, us-west1]
      image: monopacker-docker-worker-gcp-current
      worker-config:
        deviceManagement:
          kvm:
            enabled: true
        dockerConfig:
          allowPrivileged: true
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-75
            - *scratch-disk
            - *scratch-disk
          machine_type: n2-standard-16
          advancedMachineFeatures:
            enableNestedVirtualization: true
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: 'gecko-t/t-linux-vm-2204-wayland'  # Bug 1756660 - This pool is experimental
    description: Worker for testing Wayland and XWayland on Ubuntu 22.04
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    provider_id: fxci-level1-gcp
    config:
      worker-config:
        genericWorker:
          config:
            livelogExecutable: /home/ubuntu/.taskcluster/livelog
            taskclusterProxyExecutable: /home/ubuntu/.taskcluster/taskcluster-proxy
            numberOfTasksToRun: 1  # gw simple uses 1 to exit after one task
            idleTimeoutSecs: 5400
      minCapacity: 0
      maxCapacity: 500
      implementation: generic-worker/worker-runner-linux
      regions: [us-central1, us-west1]
      image: handbuilt-ubuntu-2204-wayland-vm
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - &persistent-disk-60
              autoDelete: true
              boot: true
              initializeParams:
                diskSizeGb: 60
                sourceImage: <image>
              type: PERSISTENT
          machine_type: n2-standard-2
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
          advancedMachineFeatures:
            enableNestedVirtualization: true
  - pool_id: 'gecko-t/t-linux-vm-2204-wayland-aerickson-test'  # This pool is experimental
    description: Worker for testing Wayland and XWayland on Ubuntu 22.04
    owner: aerickson@mozilla.com
    email_on_error: true
    provider_id: fxci-level1-gcp
    config:
      worker-config:
        genericWorker:
          config:
            livelogExecutable: /home/ubuntu/.taskcluster/livelog
            taskclusterProxyExecutable: /home/ubuntu/.taskcluster/taskcluster-proxy
            numberOfTasksToRun: 1  # gw simple uses 1 to exit after one task
            idleTimeoutSecs: 5400
      minCapacity: 0
      maxCapacity: 10
      implementation: generic-worker/worker-runner-linux
      regions: [us-central1, us-west1]
      image: handbuilt-ubuntu-2204-wayland-vm-aerickson-testing
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-60
          machine_type: n2-standard-2
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
          advancedMachineFeatures:
            enableNestedVirtualization: true
  - pool_id: '{pool-group}/b-linux-v100-gpu'
    description: Worker for machine learning and other high GPU tasks
    owner: release+tc-workers@mozilla.com
    variants:
      - pool-group: translations-1
    email_on_error: true
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      worker-config:
        genericWorker:
          config:
            # 2592000s is 30 days.
            maxTaskRunTime: 2592000
            enableInteractive: true
      minCapacity: 0
      maxCapacity: 50
      implementation: generic-worker/worker-runner-linux
      regions: [us-central1, us-west1]
      image: monopacker-translations-worker
      instance_types:
        - minCpuPlatform: Intel Skylake
          disks:
            - *persistent-disk-75
          machine_type: n1-highmem-8
          scheduling: spot
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
          guestAccelerators:
            - acceleratorCount: 1
              acceleratorType: nvidia-tesla-v100
  - pool_id: '{pool-group}/b-linux-v100-gpu-4'
    description: Worker for machine learning and other high GPU tasks
    owner: release+tc-workers@mozilla.com
    variants:
      - pool-group: translations-1
    email_on_error: true
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      worker-config:
        genericWorker:
          config:
            # 2592000s is 30 days.
            maxTaskRunTime: 2592000
            enableInteractive: true
      minCapacity: 0
      maxCapacity: 50
      implementation: generic-worker/worker-runner-linux
      regions: [us-central1, us-west1]
      image: monopacker-translations-worker
      instance_types:
        - minCpuPlatform: Intel Skylake
          disks:
            - *persistent-disk-75
          machine_type: n1-highmem-8
          scheduling: spot
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
          guestAccelerators:
            - acceleratorCount: 4
              acceleratorType: nvidia-tesla-v100
  - pool_id: '{pool-group}/b-linux-v100-gpu-4-300gb'
    description: Worker for machine learning and other high GPU tasks
    owner: release+tc-workers@mozilla.com
    variants:
      - pool-group: translations-1
    email_on_error: true
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      worker-config:
        genericWorker:
          config:
            # 2592000s is 30 days.
            maxTaskRunTime: 2592000
            enableInteractive: true
      minCapacity: 0
      maxCapacity: 50
      implementation: generic-worker/worker-runner-linux
      regions: [us-central1, us-west1]
      image: monopacker-translations-worker
      instance_types:
        - minCpuPlatform: Intel Skylake
          disks:
            - *persistent-disk-300
          # 40 CPUs, 256GB RAM
          machine_type: n1-custom-40-262144
          scheduling: spot
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
          guestAccelerators:
            - acceleratorCount: 4
              acceleratorType: nvidia-tesla-v100
  - pool_id: '{pool-group}/b-linux-v100-gpu-4-1tb'
    description: Worker for machine learning and other high GPU tasks
    owner: release+tc-workers@mozilla.com
    variants:
      - pool-group: translations-1
    email_on_error: true
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      worker-config:
        genericWorker:
          config:
            # 2592000s is 30 days.
            maxTaskRunTime: 2592000
            enableInteractive: true
      minCapacity: 0
      maxCapacity: 50
      implementation: generic-worker/worker-runner-linux
      regions: [us-central1, us-west1]
      image: monopacker-translations-worker
      instance_types:
        - minCpuPlatform: Intel Skylake
          disks:
            - &persistent-disk-1024
              autoDelete: true
              boot: true
              initializeParams:
                diskSizeGb: 1024
                sourceImage: <image>
              type: PERSISTENT
          # 40 CPUs, 256GB RAM
          machine_type: n1-custom-40-262144
          scheduling: spot
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
          guestAccelerators:
            - acceleratorCount: 4
              acceleratorType: nvidia-tesla-v100
  - pool_id: 'translations-1/b-linux-aerickson-test'
    description: Worker for testing new Translations images.
    owner: aerickson@mozilla.com
    email_on_error: true
    provider_id: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity: 1
      implementation: generic-worker/worker-runner-linux
      regions: [us-central1, us-west1]
      image: monopacker-translations-worker-testing
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-60
          machine_type: n2-standard-2
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/misc-gcp'
    description: Miscellaneous short, low-latency, simple tasks, shared between Gecko
      SCM levels.  Used for things like indexing tasks.  Note that disk space is limited
      (total 80GB, 9GB per task).
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: gecko-t
      - pool-group: comm-t
    provider_id: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity: 32
      regions: [us-central1, us-west1]
      image: monopacker-docker-worker-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - autoDelete: true
              boot: true
              initializeParams:
                diskSizeGb: 20
                sourceImage: <image>
              type: PERSISTENT
            - autoDelete: true
              initializeParams:
                diskType: diskTypes/local-ssd
              type: SCRATCH
              interface: NVME
            - autoDelete: true
              initializeParams:
                diskType: diskTypes/local-ssd
              type: SCRATCH
              interface: NVME
            - autoDelete: true
              initializeParams:
                diskType: diskTypes/local-ssd
              type: SCRATCH
              interface: NVME
            - autoDelete: true
              initializeParams:
                diskType: diskTypes/local-ssd
              type: SCRATCH
              interface: NVME
          machine_type: n2-standard-4
          capacityPerInstance: 8
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: gecko-1/b-win2012-azure-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-b1-windows2012-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-1
      locations: [central-us, north-central-us]
      maxCapacity: 25
      worker-config:
        genericWorker:
          config:
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: win_2012
        sourceRepository: ronin_puppet
        sourceOrganisation: markcor
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 120
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-1/b-win2012-azure-beta
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-b1-windows2012-beta
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-1
      locations: [central-us, north-central-us]
      maxCapacity: 25
      worker-config:
        genericWorker:
          config:
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: win_2012
        sourceRepository: ronin_puppet
        sourceOrganisation: markcor
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 120
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: '{pool-group}/b-win2012-azure'
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    variants:
      - pool-group: gecko-1
      - pool-group: gecko-2
      - pool-group: gecko-3
        chain-of-trust: trusted
      - pool-group: comm-1
      - pool-group: comm-2
      - pool-group: comm-3
        chain-of-trust: trusted
    provider_id:
      by-chain-of-trust:
        trusted: azure_trusted
        default: azure2
    config:
      image:
        by-chain-of-trust:
          trusted: ronin-b3-windows2012-prod
          default: ronin-b1-windows2012-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      locations: [central-us, north-central-us, east-us-2, west-us-2]
      maxCapacity:
        by-pool-group:
          gecko-.*: 500
          comm-3: 50
          comm-(1|2): 25
      worker-config:
        genericWorker:
          config:
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 120
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: mozillavpn-1/masterwayz-win2012-azure
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-b1-windows2012-bug1801167
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: vpn-1
      locations: [central-us]
      maxCapacity: 25
      worker-config:
        genericWorker:
          config:
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 120
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
                - lun: 1
                  diskSizeGB: 120
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: mozillavpn-1/b-win2012-azure
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-b1-windows2012-vs-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: vpn-1
      locations: [central-us, north-central-us, east-us-2, west-us-2]
      maxCapacity: 25
      worker-config:
        genericWorker:
          config:
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 250
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: mozillavpn-3/b-win2012-azure
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure_trusted
    config:
      image: ronin-b3-windows2012-vs-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: vpn-3
      locations: [central-us, north-central-us, east-us-2, west-us-2]
      maxCapacity: 25
      worker-config:
        genericWorker:
          config:
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 250
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: mozillavpn-1/b-win2012-azure-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-b1-windows2012-vs-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: vpn-1
      locations: [central-us, north-central-us]
      maxCapacity: 25
      worker-config:
        genericWorker:
          config:
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 250
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: nss-1/b-win2012-azure
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-b1-windows2012-vs-py2-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: nss-1
      locations: [central-us, north-central-us, east-us-2, west-us-2]
      maxCapacity: 25
      worker-config:
        genericWorker:
          config:
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 120
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: nss-3/b-win2012-azure
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure_trusted
    config:
      image: ronin-b3-windows2012-vs-py2-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: nss-3
      locations: [central-us, north-central-us, east-us-2, west-us-2]
      maxCapacity: 25
      worker-config:
        genericWorker:
          config:
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 120
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: nss-1/b-win2012-azure-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-b1-windows2012-vs-py2-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: nss-1
      locations: [central-us, north-central-us]
      maxCapacity: 25
      worker-config:
        genericWorker:
          config:
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 120
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  # Windows Server 2022
  - pool_id: gecko-1/b-win2022-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-b-windows2022-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-1
      locations: [central-us, north-central-us]
      maxCapacity: 5
      worker-config:
        genericWorker:
          config:
            workerType: win2022-azure
            cachesDir: D:\caches
            downloadsDir: D:\downloads
            tasksDir: D:\
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: bug1838725
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-1/b-win2022-rd-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-b-windows2022-rd-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-1
      locations: [central-us, north-central-us]
      maxCapacity: 5
      worker-config:
        genericWorker:
          config:
            workerType: win2022-azure
            cachesDir: D:\caches
            downloadsDir: Z:\downloads
            tasksDir: Z:\
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: bug1845790
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 1024
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
  - pool_id: '{pool-group}/b-win2022'
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    variants:
      - pool-group: gecko-1
      - pool-group: gecko-2
      - pool-group: gecko-3
        chain-of-trust: trusted
      - pool-group: comm-1
      - pool-group: comm-2
      - pool-group: comm-3
        chain-of-trust: trusted
      - pool-group: mozillavpn-1
      - pool-group: mozillavpn-3
        chain-of-trust: trusted
      - pool-group: relops-1
      - pool-group: relops-3
        chain-of-trust: trusted
    provider_id:
      by-chain-of-trust:
        trusted: azure_trusted
        default: azure2
    config:
      image:
        by-chain-of-trust:
          trusted: ronin-b3-windows2022-prod
          default: ronin-b1-windows2022-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      locations:
        by-pool-group:
          .*-3: [central-us, south-central-us, east-us-2, west-us-2]
          default: [central-us, north-central-us, east-us-2, west-us-2]
      maxCapacity:
        by-pool-group:
          gecko-.*: 500
          comm-3: 50
          comm-(1|2): 25
          mozillavpn-.*: 25
          relops-.*: 12
      worker-purpose:
        by-pool-group:
          mozillavpn-1: vpn-1
          mozillavpn-3: vpn-3
          default: null  # defaults to pool-group
      worker-config:
        genericWorker:
          config:
            cachesDir: D:\caches
            downloadsDir: D:\downloads
            tasksDir: D:\
      tags:
        sourceScript: provisioners/windows/azure/2022-azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: nss-1/b-win2022-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-b-windows2022-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: nss-1
      locations: [central-us, north-central-us]
      maxCapacity: 25
      worker-config:
        genericWorker:
          config:
            cachesDir: D:\caches
            downloadsDir: D:\downloads
            tasksDir: D:\
      tags:
        sourceScript: provisioners/windows/azure/2022-azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F32s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
            hardwareProfile:
              vmSize: Standard_F32s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  # Windows 10
  - pool_id: gecko-t/win10-64-2009
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows10-64-2009-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [canada-central, central-india, central-us, north-europe, south-india, north-central-us, east-us, east-us-2, west-us, west-us-2, west-us-3]
      maxCapacity: 600
      worker-config:
        genericWorker:
          config:
            workerType: win10-64-2009
            provisionerId: gecko-t
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: Standard_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win10-64-2009-gpu
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows10-64-2009-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [east-us, east-us-2, west-us, west-us-2]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win10-64-2009-gpu
            provisionerId: gecko-t
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_NV12s_v3
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: Standard_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_NV12s_v3
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
  - pool_id: gecko-t/win10-64-2009-source
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows10-64-2009-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [canada-central, central-india, central-us, north-europe, south-india, north-central-us, east-us, east-us-2, west-us, west-us-2, west-us-3]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win10-64-2009-source
            provisionerId: gecko-t
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 500
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win10-64-2009-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows10-64-2009-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [uk-west]
      maxCapacity: 500
      worker-config:
        genericWorker:
          config:
            workerType: win10-64-2009-alpha
            provisionerId: gecko-t
            idleTimeoutSecs: 5400
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: Standard_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win10-64-2009-source-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows10-64-2009-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [central-us, north-central-us, east-us, east-us-2, west-us, west-us-2]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win10-64-2009-source-alpha
            provisionerId: gecko-t
            idleTimeoutSecs: 5400
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 500
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win10-64-2009-gpu-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows10-64-2009-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [east-us, east-us-2, west-us, west-us-2]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win10-64-2009-gpu-alpha
            provisionerId: gecko-t
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_NV12s_v3
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: Standard_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_NV12s_v3
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
  # Windows 11
  - pool_id: gecko-t/win11-64-2009
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [canada-central, central-india, central-us, north-europe, south-india, north-central-us, east-us, east-us-2, west-us, west-us-2, west-us-3]
      maxCapacity: 600
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009
            provisionerId: gecko-t
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: StandardSSD_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win11-64-2009-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [uk-south]
      maxCapacity: 500
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009-alpha
            provisionerId: gecko-t
            idleTimeoutSecs: 5400
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: StandardSSD_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win11-64-2009-alpha-test
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-alpha-test
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [central-us, east-us, east-us-2, north-central-us, north-europe, west-us, west-us-2]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009-alpha
            provisionerId: gecko-t
            idleTimeoutSecs: 5400
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: StandardSSD_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win11-64-2009-tc-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-tc-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [central-us, east-us]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009-tc-alpha
            provisionerId: gecko-t
            idleTimeoutSecs: 5400
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: bug1831158
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: Standard_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
  - pool_id: gecko-t/win11-64-2009-gpu
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [east-us, east-us-2, west-us, west-us-2]
      maxCapacity: 600
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009-gpu
            provisionerId: gecko-t
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_NV12s_v3
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: Standard_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_NV12s_v3
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win11-64-2009-gpu-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [east-us, east-us-2]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009-gpu-alpha
            provisionerId: gecko-t
            idleTimeoutSecs: 1800
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_NV12s_v3
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: Standard_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_NV12s_v3
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
  - pool_id: gecko-t/win11-64-2009-source
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [central-us, north-central-us, east-us, east-us-2, west-us, west-us-2]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009-source
            provisionerId: gecko-t
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 500
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win11-64-2009-source-alpha
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-alpha
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [uk-south]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009-source-alpha
            provisionerId: gecko-t
            idleTimeoutSecs: 5400
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 500
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win11-64-2009-ssd
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [central-us, north-central-us, east-us, east-us-2, west-us, west-us-2]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009-ssd
            provisionerId: gecko-t
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                diskSizeGB: 500
                osType: Windows
                managedDisk:
                  storageAccountType: Premium_LRS
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 120
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: gecko-t/win11-64-2009-ssd-gpu
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: gecko-t
      locations: [east-us, north-europe]
      maxCapacity: 100
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009-ssd-gpu
            provisionerId: gecko-t
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_NV12s_v3
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                diskSizeGB: 500
                osType: Windows
                managedDisk:
                  storageAccountType: Premium_LRS
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_NV12s_v3
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: comm-t/win11-64-2009
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: comm-t
      locations: [canada-central, central-india, central-us, north-europe, south-india, north-central-us, east-us, east-us-2, west-us, west-us-2, west-us-3]
      maxCapacity: 600
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009
            provisionerId: gecko-t
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                osType: Windows
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 30
                  managedDisk:
                    storageAccountType: Standard_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: comm-t/win11-64-2009-ssd
    description: ''
    owner: relops-azure-provisioning@mozilla.com
    email_on_error: true
    provider_id: azure2
    config:
      image: ronin-t-windows11-64-2009-prod
      image_resource_group: rg-packer-through-cib
      implementation: generic-worker/worker-runner-windows
      worker-purpose: comm-t
      locations: [central-us, north-central-us, east-us, east-us-2, west-us, west-us-2]
      maxCapacity: 50
      worker-config:
        genericWorker:
          config:
            workerType: win11-64-2009-ssd
            provisionerId: gecko-t
      tags:
        sourceScript: provisioners/windows/azure/azure-bootstrap.ps1
        sourceBranch: cloud_windows
        sourceRepository: ronin_puppet
        sourceOrganisation: mozilla-platform-ops
      spot: true
      vmSizes:
        - vmSize: Standard_F8s_v2
          launchConfig:
            osProfile:
              windowsConfiguration:
                timeZone: UTC
                enableAutomaticUpdates: false
            storageProfile:
              osDisk:
                diskSizeGB: 500
                osType: Windows
                managedDisk:
                  storageAccountType: Premium_LRS
                createOption: FromImage
              dataDisks:
                - lun: 0
                  diskSizeGB: 120
                  managedDisk:
                    storageAccountType: Premium_LRS
                  createOption: Empty
            hardwareProfile:
              vmSize: Standard_F8s_v2
            diagnosticsProfile:
              bootDiagnostics:
                enabled: false
      capacityPerInstance: 1
  - pool_id: '{pool-group}/t-linux-large-gcp'
    description: Worker for gecko-based automation.
    owner: release+tc-workers@mozilla.com
    provider_id: fxci-level1-gcp
    variants:
      - pool-group: gecko-t
      - pool-group: comm-t
      - pool-group: mozilla-t
    email_on_error: true
    config:
      minCapacity: 0
      maxCapacity:
        by-pool-group:
          gecko-t: 2500
          comm-t: 100
          mozilla-t: 100
      regions: [us-central1, us-west1]
      image: monopacker-docker-worker-gcp-current
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - autoDelete: true
              boot: true
              initializeParams:
                diskSizeGb: 75
                sourceImage: <image>
              type: PERSISTENT
            - autoDelete: true
              initializeParams:
                diskType: diskTypes/local-ssd
              type: SCRATCH
              interface: NVME
          machine_type: n2-standard-2
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: 'gecko-t/t-linux-large-hostub2204-gcp'
    description: Worker for gecko-based automation.
    owner: release+tc-workers@mozilla.com
    provider_id: fxci-level1-gcp
    email_on_error: true
    config:
      minCapacity: 0
      maxCapacity: 200
      regions: [us-central1, us-west1]
      image: monopacker-docker-worker-relops528
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - autoDelete: true
              boot: true
              initializeParams:
                diskSizeGb: 75
                sourceImage: <image>
              type: PERSISTENT
            - autoDelete: true
              initializeParams:
                diskType: diskTypes/local-ssd
              type: SCRATCH
              interface: NVME
          machine_type: n2-standard-2
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: relops-3/win2019
    description: build windows cloud images for taskcluster windows workloads
    owner: relops-aws-provisioning@mozilla.com
    email_on_error: true
    provider_id: aws
    config:
      image: relops-image-builder-current
      maxCapacity: 12
      regions: [eu-central-1, us-east-1, us-west-1, us-west-2]
      security: trusted
      implementation: generic-worker/windows
      additional-user-data:
        workerType: relops-image-builder
      instance_types:
        - instanceType: c5.4xlarge
          launchConfig:
            BlockDeviceMappings:
              - DeviceName: /dev/sda1
                Ebs: {DeleteOnTermination: true, VolumeSize: 40, VolumeType: gp2}
              - DeviceName: /dev/sdb
                Ebs: {DeleteOnTermination: true, VolumeSize: 120, VolumeType: gp2}
              - DeviceName: /dev/sdc
                Ebs: {DeleteOnTermination: true, VolumeSize: 120, VolumeType: gp2}
  - pool_id: mobile-1/bitrise-gcp
    description: Level 1 workers to interact with bitrise.io (iOS CI)
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    provider_id: fxci-level1-gcp
    config:
      image: monopacker-docker-worker-current
      minCapacity: 0
      maxCapacity: 1  # We can only have 3 concurrent builds with the plan we pay. Let's not overload the queue with level 1 jobs
      regions: [us-central1, us-west1]
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-20
            - *scratch-disk
          # No need for a big instance, it just delegates the heavy lifting to
          # bitrise.
          machine_type: n2-standard-2
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: mobile-3/bitrise-gcp
    description: Level 3 workers to interact with bitrise.io (iOS CI)
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    provider_id: fxci-level3-gcp
    config:
      image: monopacker-docker-worker-trusted-current-gcp
      minCapacity: 0
      maxCapacity: 3  # We can only have 3 concurrent builds with the plan we pay
      regions: [us-central1, us-west1]
      security: trusted
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-20
            - *scratch-disk
          # No need for a big instance, it just delegates the heavy lifting to
          # bitrise.
          machine_type: n2-standard-2
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: project-relman/relman-svc
    description: Release management workers
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    provider_id: fxci-level1-gcp
    config:
      regions: [us-central1, us-west1]
      image: monopacker-docker-worker-current
      minCapacity: 0
      maxCapacity: 2
      worker-config:
        shutdown:
          afterIdleSeconds: 15
      instance_types:
        - machine_type: n2-standard-2
          disks:
            - *persistent-disk-20
            - *scratch-disk
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: code-review/bot-gcp
    description: Worker for the code-review bot.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    provider_id: fxci-level1-gcp
    config:
      regions: [us-central1, us-west1]
      image: monopacker-docker-worker-current
      minCapacity: 1
      maxCapacity: 100
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-20
            - *scratch-disk
          machine_type: n2-standard-2
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: code-coverage/bot-gcp
    description: Worker for the code-coverage bot.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    provider_id: fxci-level1-gcp
    config:
      regions: [us-central1, us-west1]
      image: monopacker-docker-worker-current
      minCapacity: 1
      maxCapacity: 100
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-75
            - *scratch-disk
          machine_type: n2-standard-4
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: '{pool-group}/linux-gcp'
    description: Worker for gecko-based automation.
    owner: release+tc-workers@mozilla.com
    email_on_error: true
    variants:
      - pool-group: ci-t
      - pool-group: code-analysis-1
      - pool-group: code-analysis-3
        chain-of-trust: trusted
      - pool-group: nss-1
      - pool-group: nss-3
        chain-of-trust: trusted
      - pool-group: releng-t
      - pool-group: releng-1
      - pool-group: releng-3
        chain-of-trust: trusted
      - pool-group: taskgraph-t
    provider_id:
      by-chain-of-trust:
        trusted: fxci-level3-gcp
        default: fxci-level1-gcp
    config:
      minCapacity: 0
      maxCapacity:
        by-pool-group:
          nss-.*: 100
          default: 10
      regions: [us-central1, us-west1]
      image:
        by-chain-of-trust:
          trusted: monopacker-docker-worker-trusted-current-gcp
          default: monopacker-docker-worker-current
      security:
        by-chain-of-trust:
          trusted: trusted
          default:
      instance_types:
        - minCpuPlatform: Intel Cascadelake
          disks:
            - *persistent-disk-75
            - *scratch-disk
            - *scratch-disk
          machine_type: n2-standard-4
          networkInterfaces:
            - accessConfigs:
                - type: ONE_TO_ONE_NAT
  - pool_id: performance-hardware/gecko-t-fxrecorder
    description: Desktop startup recorder machines
    owner: barret@mozilla.com
    email_on_error: false
    provider_id: static
    config: {}
