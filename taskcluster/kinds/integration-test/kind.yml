# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.
---
loader: taskgraph.loader.transform:loader

kind-dependencies:
  - firefoxci-artifact

transforms:
  - fxci_config_taskgraph.transforms.integration_test

tasks:
  translations-decision:
    # needed to run the action, which is the thing we actually care about
    description: "Run translations decision task"
    decision:
      repo: https://github.com/mozilla-releng/staging-firefox-translations-training
      branch: main
      project: staging-firefox-translations-training

  translations-action:
    description: "Run translations pipeline test"
    action:
      depends:
        # TODO: shouldn't be gecko here
        translations-decision: gecko-integration-test-translations-decision
      # TODO: real repo
      repo: https://github.com/mozilla-releng/staging-firefox-translations-training
      branch: main
      project: staging-firefox-translations-training
      name: train
      perm: train
      # This action has sane defaults for all required values
      input: ""

  gecko:
    description: "Run Gecko integration tests"
    decision-index-paths:
      - gecko.v2.mozilla-central.latest.taskgraph.decision-os-integration
