---
project-relman/code-coverage-repo-production:
  name: Code coverage hook (production)
  description: Automatically build code coverage reports
  owner: release-mgmt-analysis@mozilla.com
  email_on_error: true
  scopes:
    - assume:project:taskcluster:mozilla-github-repository
    - docker-worker:cache:code-coverage-bot-production
    - index:insert-task:project.releng.services.project.production.code_coverage_bot.*
    - index:insert-task:project.relman.code-coverage.production.repo.*
    - notify:email:*
    - queue:create-task:highest:code-coverage/bot
    - queue:route:notify.email.*
    - queue:scheduler-id:relman
    - secrets:get:project/relman/code-coverage/runtime-production
  template_file: hooks/project-relman/code-coverage-repo-production.yml
  trigger_schema:
    type: object
    additionalProperties: true

project-relman/code-coverage-repo-testing:
  name: Code coverage hook (testing)
  description: Automatically build code coverage reports
  owner: release-mgmt-analysis@mozilla.com
  email_on_error: true
  scopes:
    - assume:project:taskcluster:mozilla-github-repository
    - docker-worker:cache:code-coverage-bot-testing
    - index:insert-task:project.relman.code-coverage.testing.repo.*
    - notify:email:*
    - queue:create-task:lowest:code-coverage/bot
    - queue:route:notify.email.*
    - queue:scheduler-id:relman
    - secrets:get:project/relman/code-coverage/runtime-testing
  template_file: hooks/project-relman/code-coverage-repo-testing.yml
  trigger_schema:
    type: object
    additionalProperties: true

project-relman/code-coverage-cron-production:
  name: Code coverage hook (production)
  description: Automatically build code coverage reports
  owner: release-mgmt-analysis@mozilla.com
  email_on_error: true
  schedule:
    - "0 0 0 * * *"
  scopes:
    - assume:project:taskcluster:mozilla-github-repository
    - docker-worker:cache:code-coverage-bot-production
    - index:insert-task:project.releng.services.project.production.code_coverage_bot.*
    - index:insert-task:project.relman.code-coverage.production.cron.*
    - notify:email:*
    - queue:create-task:highest:code-coverage/bot
    - queue:route:notify.email.*
    - queue:scheduler-id:relman
    - secrets:get:project/relman/code-coverage/runtime-production
  template_file: hooks/project-relman/code-coverage-cron-production.yml
  trigger_schema:
    type: object
    additionalProperties: true

project-relman/code-coverage-cron-testing:
  name: Code coverage hook (testing)
  description: Automatically build code coverage reports
  owner: release-mgmt-analysis@mozilla.com
  email_on_error: true
  schedule:
    - "0 0 0 * * *"
  scopes:
    - assume:project:taskcluster:mozilla-github-repository
    - docker-worker:cache:code-coverage-bot-testing
    - index:insert-task:project.relman.code-coverage.testing.cron.*
    - notify:email:*
    - queue:create-task:lowest:code-coverage/bot
    - queue:route:notify.email.*
    - queue:scheduler-id:relman
    - secrets:get:project/relman/code-coverage/runtime-testing
  template_file: hooks/project-relman/code-coverage-cron-testing.yml
  trigger_schema:
    type: object
    additionalProperties: true

project-relman/code-review-testing:
  name: Code review hook (testing)
  description: Automatically create code review publication tasks
  owner: release-mgmt-analysis@mozilla.com
  email_on_error: true
  scopes:
    - assume:project:taskcluster:mozilla-github-repository
    - hooks:trigger-hook:project-releng/services-testing-*
    - index:insert-task:project.relman.testing.code-review.*
    - notify:email:*
    - queue:create-task:lowest:code-review/bot
    - queue:route:index.project.releng.services.project.testing.static_analysis_bot.*
    - queue:route:index.project.relman.testing.code-review.*
    - queue:route:notify.email.*
    - queue:scheduler-id:relman
    - secrets:get:project/relman/code-review/runtime-testing
  template_file: hooks/project-relman/code-review-testing.yml
  bindings:
    - exchange: exchange/taskcluster-queue/v1/task-completed
      routing_key_pattern: route.project.relman.codereview.v1.try_ending
  trigger_schema:
    type: object
    additionalProperties: true

project-relman/code-review-production:
  name: Code review hook (production)
  description: Automatically create code review publication tasks
  owner: release-mgmt-analysis@mozilla.com
  email_on_error: true
  scopes:
    - assume:project:taskcluster:mozilla-github-repository
    - hooks:trigger-hook:project-releng/services-production-*
    - index:insert-task:project.relman.production.code-review.*
    - notify:email:*
    - queue:create-task:highest:code-review/bot
    - queue:route:index.project.releng.services.project.production.static_analysis_bot.*
    - queue:route:index.project.relman.production.code-review.*
    - queue:route:notify.email.*
    - queue:scheduler-id:relman
    - secrets:get:project/relman/code-review/runtime-production
  template_file: hooks/project-relman/code-review-production.yml
  bindings:
    - exchange: exchange/taskcluster-queue/v1/task-completed
      routing_key_pattern: route.project.relman.codereview.v1.try_ending
  trigger_schema:
    type: object
    additionalProperties: true

project-relman/bugzilla-dashboard-backend-production:
  name: Bugzilla dashboard data generation (production)
  description: Regularly create bugzilla dashboard datasets
  owner: release-mgmt-analysis@mozilla.com
  email_on_error: true
  schedule:
    - '0 0 */6 * * *'
  scopes:
    - assume:project:taskcluster:mozilla-github-repository
    - index:insert-task:project.relman.production.bugzilla-dashboard.*
    - queue:create-task:highest:project-relman/relman-svc
    - queue:route:index.project.relman.production.bugzilla-dashboard.*
    - queue:scheduler-id:relman
    - secrets:get:project/relman/bugzilla-dashboard/runtime-production
  template_file: hooks/project-relman/bugzilla-dashboard-backend-production.yml
  trigger_schema:
    type: object
    additionalProperties: true

project-relman/bugzilla-dashboard-backend-testing:
  name: Bugzilla dashboard data generation (testing)
  description: Regularly create bugzilla dashboard datasets
  owner: release-mgmt-analysis@mozilla.com
  email_on_error: true
  schedule:
    - '0 0 */6 * * *'
  scopes:
    - assume:project:taskcluster:mozilla-github-repository
    - index:insert-task:project.relman.testing.bugzilla-dashboard.*
    - queue:create-task:lowest:project-relman/relman-svc
    - queue:route:index.project.relman.testing.bugzilla-dashboard.*
    - queue:scheduler-id:relman
    - secrets:get:project/relman/bugzilla-dashboard/runtime-testing
  template_file: hooks/project-relman/bugzilla-dashboard-backend-testing.yml
  trigger_schema:
    type: object
    additionalProperties: true

# - mozilla-mobile
# TODO Convert to cron.yml supported
#      see https://github.com/mozilla-mobile/android-components/issues/5069

# was project-mobile/android-components-api-docs-update
project-releng/cron-task-mozilla-mobile-android-components/api-docs-update:
  name: "Android Components - API docs Update"
  description: >-
    Hook for updating the API docs automatically.

    Managed from ci-configuration's hooks.yml for now.
  owner: skaspari@mozilla.com
  email_on_error: true
  schedule:
    - '0 0 12 * * *'
  scopes:
    - queue:scheduler-id:mobile-level-3
    - queue:create-task:lowest:mobile-3/b-linux
    - secrets:get:project/mobile/github
  template_file: hooks/project-releng/cron-task-mozilla-mobile-android-components/api-docs-update.yml
  trigger_schema:
    type: object
    properties: {}
    additionalProperties: false

# was project-mobile/android-components-geckoview-update-beta
project-releng/cron-task-mozilla-mobile-android-components/gv-update-beta:
  name: "Android Components - GeckoView Update (Beta)"
  description: >-
    Updating GeckoView Beta dependency.

    Managed from ci-configuration's hooks.yml for now.
  owner: skaspari@mozilla.com
  email_on_error: true
  schedule:
    - '0 0 14 * * *'
  scopes:
    - queue:scheduler-id:mobile-level-3
    - queue:create-task:lowest:mobile-3/b-linux
    - secrets:get:project/mobile/github
  template_file: hooks/project-releng/cron-task-mozilla-mobile-android-components/geckoview-update-beta.yml
  trigger_schema:
    type: object
    properties: {}
    additionalProperties: false

# was project-mobile/android-components-geckoview-update-nightly
project-releng/cron-task-mozilla-mobile-android-components/gv-update-nightly:
  name: "Android Components - GeckoView Update (Nightly)"
  description: >-
    Updating GeckoView Nightly dependency.

    Managed from ci-configuration's hooks.yml for now.
  owner: skaspari@mozilla.com
  email_on_error: true
  schedule:
    - '0 0 14 * * *'
  scopes:
    - queue:scheduler-id:mobile-level-3
    - queue:create-task:lowest:mobile-3/b-linux
    - secrets:get:project/mobile/github
  template_file: hooks/project-releng/cron-task-mozilla-mobile-android-components/geckoview-update-nightly.yml
  trigger_schema:
    type: object
    properties: {}
    additionalProperties: false

# was project-mobile/android-components-geckoview-update-release
project-releng/cron-task-mozilla-mobile-android-components/gv-update-release:
  name: "Android Components - GeckoView Update (Release)"
  description: >-
    Updating GeckoView Release dependency.

    Managed from ci-configuration's hooks.yml for now.
  owner: skaspari@mozilla.com
  email_on_error: true
  schedule:
    - '0 0 14 * * *'
  scopes:
    - queue:scheduler-id:mobile-level-3
    - queue:create-task:lowest:mobile-3/b-linux
    - secrets:get:project/mobile/github
  template_file: hooks/project-releng/cron-task-mozilla-mobile-android-components/geckoview-update-release.yml
  trigger_schema:
    type: object
    properties: {}
    additionalProperties: false

# was project-mobile/android-components-publicsuffixlist-update
project-releng/cron-task-mozilla-mobile-android-components/suffixlist-update:
  name: "Android Components - Public Suffix List Update"
  description: >-
    Hook for updating the Public Suffix List automatically.

    Managed from ci-configuration's hooks.yml for now.
  owner: skaspari@mozilla.com
  email_on_error: true
  schedule:
    - '0 0 14 * * *'
  scopes:
    - queue:scheduler-id:mobile-level-3
    - queue:create-task:lowest:mobile-3/b-linux
    - secrets:get:project/mobile/github
  template_file: hooks/project-releng/cron-task-mozilla-mobile-android-components/publicsuffixlist-update.yml
  trigger_schema:
    type: object
    properties: {}
    additionalProperties: false

# was project-mobile/focus-nightly-public
project-releng/cron-task-mozilla-mobile-focus-android/nightly-public:
  name: "Focus/Klar Nightly Builds (Public)"
  description: >-
    Public Nightly builds of Focus/Klar. Automatically signed and uploaded to "nightly" track of Google
    Play. https://github.com/mozilla-mobile/focus-android/wiki/Release-tracks

    Managed from ci-configuration's hooks.yml for now.
  owner: skaspari@mozilla.com
  email_on_error: true
  schedule: []
  scopes:
    - assume:repo:github.com/mozilla-mobile/focus-android:cron:nightly
  template_file: hooks/project-releng/cron-task-mozilla-mobile-focus-android/nightly-public.yml
  trigger_schema:
    type: object
    properties: {}
    additionalProperties: false
